<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>The RSA Algorithm</title>
    
    <script src="../jquery.js"></script> 
    <script> 
        $(function(){
          $("#includedContent").load("../header.html"); 
        });
    </script> 
    <script type="text/javascript" src="../script.js"></script>
    <link rel="stylesheet" type="text/css" href="../jba_style.css">
</head>


<body>
    <div id="includedContent"></div>

        
<table style="width:100%"  cellspacing="0" cellpadding="07" >
    <col style="width:15%">
    <col style="width:85%">
    <tr> 
    <td valign="top" width="122" style="background-color:rgb(152, 177, 201)"> 
    </td>
    <td>
    <h1>The RSA Algorithm </h1>

    <h3>Next Prime </h3> 
    Number:
    <input type="text" id="txtNextPrime1">
    <script>
        function btnNextPrime1OnClick() {
            let n = BigInt(document.getElementById('txtNextPrime1').value);
            let p = findNextPrimeBig(n);
            let result = "p = ";
            result += p;
            document.getElementById('nextPrime1Result').innerHTML = result;
        }
    </script>
    <button id="btnNextPrime1" onclick=btnNextPrime1OnClick()>Submit</button> <br />
    <p id="nextPrime1Result"></p>



    <h3>Next Prime </h3>
    Number:
    <input type="text" id="txtNextPrime2">
    <script>
        function btnNextPrime2OnClick() {
            let n = BigInt(document.getElementById('txtNextPrime2').value);
            let p = findNextPrimeBig(n);
            let result = "q = ";
            result += p;
            document.getElementById('nextPrime2Result').innerHTML = result;
        }
    </script>
    <button id="btnNextPrime2" onclick=btnNextPrime2OnClick()>Submit</button> <br />
    <p id="nextPrime2Result"></p>

    <h3>Multiplication</h3>
    <p>To compute <i>n</i> = <i>pq</i></p>
    <input type="text" id="txtMultiply1A">
    *
    <input type="text" id="txtMultiply1B">
    <script>
        function btnMultiply1OnClick() {            
            let aStr = document.getElementById('txtMultiply1A').value;
            aStr = removeSpaces(aStr);
            let a = BigInt(aStr);
            let bStr = document.getElementById('txtMultiply1B').value;
            bStr = removeSpaces(bStr);
            let b = BigInt(bStr);
            let result = "n = ";
            result += a * b;
            document.getElementById('btnMultiply1Result').innerHTML = (result);
        }
    </script>
    <button id="btnMultiply1" onclick=btnMultiply1OnClick()>Submit</button> <br />
    <p id="btnMultiply1Result"></p>

    <h3>Multiplication </h3>
    <p>To compute &phi;(<i>n</i>) = (<i>p</i >- 1)(<i>q</i> - 1)</p>
    <input type="text" id="txtMultiply2A">
    *
    <input type="text" id="txtMultiply2B">
    <script>
        function btnMultiply2OnClick() {
            let aStr = document.getElementById('txtMultiply2A').value;
            aStr = removeSpaces(aStr);
            let a = BigInt(aStr);
            let bStr = document.getElementById('txtMultiply2B').value;
            bStr = removeSpaces(bStr);
            let b = BigInt(bStr);
            let result = "(p - 1)(q - 1) = ";
            result += a * b;
            document.getElementById('btnMultiply2Result').innerHTML = (result);
        }
    </script>
    <button id="btnMultiply2" onclick=btnMultiply2OnClick()>Submit</button> <br />
    <p id="btnMultiply2Result"></p>



    <h3>GCD </h3>
    <p> Compute gcd(exponent, (<i>p</i> - 1)(<i>q</i> - 1))</p>
    First number:
    <input type="text" id="txtGcdBigA"> <br />
    Second number:
    <input type="text" id="txtGcdBigB"> <br />
    <script>
        function btnGcdBigOnClick() {
            let a = BigInt(document.getElementById('txtGcdBigA').value);
            let b = BigInt(document.getElementById('txtGcdBigB').value);
            let result = "gcd = ";
            result += gcdBig(a, b);
            document.getElementById('gcdBigResult').innerHTML = result;
        }
    </script>
    <button id="btnGcdBig" onclick=btnGcdBigOnClick()>Submit</button> <br />
    <p id="gcdBigResult"></p>



    <h3>Convert Text to ASCII Numbers (grouping into quadraphs)</h3>
    Text:
    <input type="text" id="txtNumListAscii">
    <script>
        function btnNumListAsciiOnClick() {
            let text = document.getElementById('txtNumListAscii').value;
            let nums = phTxtNumsAscii(text);
            let numsStr = "";
                    for(let i = 0; i < nums.length; i++) {
                        numsStr += nums[i];
                        if(i != nums.length - 1) numsStr += ", ";
                    }


            document.getElementById('numListAsciiResult').innerHTML = numsStr;
        }
    </script>
    <button id="btnNumListAscii" onclick=btnNumListAsciiOnClick()>Submit</button> <br />
    <p id="numListAsciiResult"></p>





    <h3>Exponentiation (Encrypt) </h3>
    Number List:
    <input type="text" id="txtExponentiateNums1Big"> <br />
    Exponent:
    <input type="text" id="txtExponentiatePow1Big"> <br />
    Modulus (<i>n</i>):
    <input type="text" id="txtExponentiateMod1Big"> <br />
    <script>
        function btnExponentiate1BigOnClick() {
            let numsStr = document.getElementById('txtExponentiateNums1Big').value;
            numsStr = removeSpaces(numsStr);
            let nums = numsStr.split(',');
            let t = (document.getElementById('txtExponentiatePow1Big').value);
            let p = (document.getElementById('txtExponentiateMod1Big').value);

            let result = phExponentiate(nums, t, p);
            let resultNumsStr = "";
                    for(let i = 0; i < result.length; i++) {
                        resultNumsStr += result[i];
                        if(i != result.length - 1) resultNumsStr += ", ";
                    }
            document.getElementById('exponentiateResult1Big').innerHTML = resultNumsStr;
        }
    </script>
    <button id="btnExponentiate1Big" onclick=btnExponentiate1BigOnClick()>Submit</button><br />
    <p id="exponentiateResult1Big"></p>



    <h3>Multiplicative Inverse </h4>
        Number:
        <input type="text" id="txtMultInverseNumBig"> <br />
        Modulus:
        <input type="text" id="txtMultInverseModBig"> <br />
        <script>
            function btnMultInverseBigOnClick() {
                let a = BigInt(document.getElementById('txtMultInverseNumBig').value);
                let b = BigInt(document.getElementById('txtMultInverseModBig').value);
                let result = "Inverse = ";
                result += multInverseModnBig(a, b);
                document.getElementById('multInverseResultBig').innerHTML = result;        
            }
        </script>
        <button id="btnMultInverseBig" onclick=btnMultInverseBigOnClick()>Submit</button><br />
        <p id="multInverseResultBig"></p>





    <h3>Exponentiation (Decrypt) </h3>
    Number List:
    <input type="text" id="txtExponentiateNums2Big"> <br />
    Exponent:
    <input type="text" id="txtExponentiatePow2Big"> <br />
    Modulus (<i>n</i>):
    <input type="text" id="txtExponentiateMod2Big"> <br />
    <script>
        function btnExponentiate2BigOnClick() {
            let numsStr = document.getElementById('txtExponentiateNums2Big').value;
            numsStr = removeSpaces(numsStr);
            let nums = numsStr.split(',');
            let t = (document.getElementById('txtExponentiatePow2Big').value);
            let p = (document.getElementById('txtExponentiateMod2Big').value);
            let result = phExponentiate(nums, t, p);
            let resultNumsStr = "";
                    for(let i = 0; i < result.length; i++) {
                        resultNumsStr += result[i];
                        if(i != result.length - 1) resultNumsStr += ", ";
                    }
            document.getElementById('exponentiateResult2Big').innerHTML = resultNumsStr;
        }
    </script>
    <button id="btnExponentiate2Big" onclick=btnExponentiate2BigOnClick()>Submit</button><br />
    <p id="exponentiateResult2Big"></p>


        
        <h3>ASCII Numbers (as quadgraphs) to Text</h4>
            <input type="text" id="txtNumTextAscii"> <br />
            <script>
                function btnNumTxtAsciiOnClick() {
                    let numsStr = document.getElementById('txtNumTextAscii').value;
                    numsStr = removeSpaces(numsStr);
                    let nums = numsStr.split(',');
                    for(let i = 0; i < nums.length; i++) {
                        nums[i] = parseInt(nums[i]);
                    }
                    let result = phNumsTxtAscii(nums);
                    document.getElementById('numTxtAsciiResult').innerHTML = result;
                }
            </script>
            <button id="btnNumTxtAscii" onclick=btnNumTxtAsciiOnClick()>Submit</button><br />
            <p id="numTxtAsciiResult"></p>


        <h2>How it works</h2>
        <p>The receiver first does some compuation to create a public encrypting key. Anyone can access this, and it is all that the send will need to perform the encryption.</p>
        <table>
            <tr>
                <td><img src="../images/lock.png" alt="Unlock" ALIGN="middle"  height="42" width="42"></td> 
                <td><h3>Encryption:</h3></td>
            </tr>
        </table> 
        <ol>

            <li>To create a public key, the receiver first finds two large primes <i>p</i> and <i>q</i>. Use the Next Prime tools to find your primes.</li>
            <li> The receiver uses the Multiplication tool to compute <i>n</i> = <i>pq</i>.</li>
            <li>The receiver uses the Multiplication tool to compute &phi;(<i>n</i>) = (<i>p</i >- 1)(<i>q</i> - 1). </li>
            <li> The receiver chooses an encrypting exponent <i>t</i> and checks to make sure that <br> gcd(<i>t</i>, (<i>p</i> - 1)(<i>q</i> - 1)) = 1. If it isn't they choose a different <i>t</i>.</li>
            <li> Now the receiver makes public the values of <i>n</i> and <i>t</i>. The values of <i>p</i>, <i>q</i>, and &phi;(<i>n</i>) remain secret, known only to the receiver.</li>
            <li> The sender now converts their message to numbers. In this activity, we will group letters into quadgraphs as in the previous activity. The Convert Text to ASCII Numbers tool will accomplish that.</li>
            <li>Each number is encypted by raising it to the power <i>t</i> and reducing mod <i>n</i>. The Exponentiation tool will do with. The resulting list of numbers is our ciphertext.</li>
        </ol>
        <button type="button" class="collapsible">Example</button>
        <div class="content">
       We will encrypt the message: 
       <div class="preDiv">
           RSA is a Really Simple Algorithm!

       </div>
        <ol>
          <li> First the receive chooses two primes. We eventually want their product to have at least 13 digits, so we'll choose primes that have 7 digits. We compute the Next Prime after 1234567:
              <div class="preDivLeft">p = 1234577</div>
             and the Next Prime after 7654321:
             <div class="preDivLeft">q = 7654337</div>
       
          We use the Multiplication tool to multiply to get <i>n</i>:
          <div class="preDivLeft">n = 9449868410449</div>
        </li>
          <li> We compute &phi;(<i>n</i>) by multiplying <i>p</i> -1 and <i>q</i> - 1: </li>
          <div class="preDivLeft">(p - 1)(q - 1) = 9449859521536</div>
          <li>We try 1234 for our encypting exponent, but when we compute its gcd with 9449859521536, we get:
            <div class="preDivLeft">gcd = 2</div>
            So we try the 12345 for our exponent. We get:
            <div class="preDivLeft">gcd = 1</div>
          </li>
          <li>Now we publish <i>n</i> = 9449868410449 and <i>t</i> = 12345</li>
          <li>The sender now converts our message, "RSA is a Really Simple Algorithm!" to numbers using the Convert Text to ASCII Numbers tool:
              <div class="preDivLeft">
                82083065032, 105115032097, 32082101097, 108108121032, 83105109112, 108101032065, 108103111114, 105116104109, 33081081081
              </div></li>
            <li>Using the Exponentiation tool, the sender raises each of these to the power 12347 mod 9449868410449:
                <div class="preDivLeft">3929263928207, 4813479453532, 2063612963052, 4403808659658, 7263379505336, 7377213689171, 4514874730375, 1840509214442, 5703693809977</div>
            This is our ciphertext.
            </li>
        </ol>
  
        </div>

        <table>
            <tr>
                <td><img src="../images/unlock.png" alt="Unlock" ALIGN="middle"  height="42" width="42"></td> 
                <td><h3>Decryption:</h3></td>
            </tr>
        </table> 
        <ol>
            <li>The receiver first uses the Multiplicative Inverse tool to compute the decrypting exponent, which is the multpilcative inverse of mod (<i>p</i> - 1)(<i>q</i> - 1)) . 
            <li>Each number in the ciphertext is raised to the power of the decrypting exponent and reduced mod <i>n</i>. Again the Exponentiation tool will do this for a list of numbers. (Note the Exponentiation (Encrypt) and Exponetiation (Decrypt) tools do the same computation.)</li>
            <li>Use the ASCII Numbers (as quadgraphs) to Text to convert back to the original plaintext.</li>
        </ol>

        <button type="button" class="collapsible">Example</button>
        <div class="content">
            <p>We will decrypt the message from the previous example.</p>
            <ol>
            <li> First we use the Multiplicative Inverse tool to compute the inverse of 12345 mod 9449859521536 i.e. mod (<i>p</i> - 1)(<i>q</i> - 1):
                <div class="preDivLeft">860400332297</div>
            </li>
            <li>Using the Exponentiation tool, we raise each of number in the ciphertext to the power 860400332297 mod 9449868410449:</li>
            <div class="preDivLeft">82083065032, 105115032097, 32082101097, 108108121032, 83105109112, 108101032065, 108103111114, 105116104109, 33081081081</div>
            </ol>
            <li>Finally, we use the ASCII Numbers (as quadgraphs) to Text to convert back to text:</li>
            <div class="preDivLeft">RSA is a Really Simple Algorithm!QQQ</div>
        </div>        
        <table>
            <tr>
                <td><img src="../images/topsecret.png" alt="Unlock" ALIGN="middle"  height="60" ></td> 
                <td><h2>Group Message Exchange</h2></td>
            </tr>
        </table>
        <p> Ths exchanges works very differently, so please read the directions below carefully.</p>
        <ol>
          <li> Public key generation
              <ol type="a">
                  <li> Generate two large (at least 7 digit) prime numbers and compute their product <i>n</i>.
                 </li>
                 <li> Choose an encrypting exponent <i>t</i> and be sure to check that <br> gcd(<i>t</i>, (<i>p</i> - 1)(<i>q</i> - 1)) = 1.</li>
                 <li>In the RSA forum of the Student Messages section of Blackboard post your public key: <i>n</i> and <i>t</i> in you group's thread.</li>
                </ol>
            </li>
            <li>Encryption </li>
            <ol type="a">
                <li>Decide on a message to send. </li>
                <li>
                    For each other group, look up their public key and encrypt your message. Again for emphasis: use <i>their</i> public to encrypt <i>your</i> message.
                </li>
                <li>Post your ciphertext in the other group's thread.</li>
            </ol>
            <li>Decryption
            </li >
            <ol type="a">
                <li>Compute your inverse exponent.</li>
                <li> Decrypt each message in your thread.</li>
            </ol>

        </ol>
        
        <table>
            <tr>
                <td><img src="../images/challenge.jpg" alt="Unlock" ALIGN="middle"  height="60" ></td> 
                <td><h2>Cryptanalysis Challenge</h2></td>
            </tr>

        </table>
        <p>Cryptanalyze the message below:</p>
        <div class="preDivleft">
            n = 1000000000000000000000000000000490004300000000000000000000000000002107 
        </div>
        <div class="preDivleft">
            t = 54321
        </div>
        <p>Ciphertext:</p>
        <div class="preDivleft">
            171020554791417762515618362423885710006585544099089672120593569616557, 775642446484419444953464292813736823382743941098831470953524182052639, 759450773636726279936960163758650192732201267337209044990561309737407, 550725081118685169230481026720650329928394082230620554743833487719335, 8323032316205142123928881250017867754282517720443904180325932513411, 175412643646438285931437428930714973294783833837996816130604832389494, 878675128643332410578110974152782675176979200401355416539070179306959
        </div>

        <p>You will need a high powered tool to factor <i>n</i> like <a href="https://www.alpertron.com.ar/ECM.HTM" target="_blank">this one</a>  or <a href="https://www.numberempire.com/numberfactorizer.php">this one</a> </p>

        <script>
            var coll = document.getElementsByClassName("collapsible");
            var i;
            
            for (i = 0; i < coll.length; i++) {
              coll[i].addEventListener("click", function() {
                this.classList.toggle("active");
                var content = this.nextElementSibling;
                if (content.style.display === "block") {
                  content.style.display = "none";
                } else {
                  content.style.display = "block";
                }
              });
            }
            </script>

</body>
</html>



<!-- Old Code


    <h3>GCD</h3>

    First number:
    <input type="text" id="txtGcdA"> <br />
    Second number:
    <input type="text" id="txtGcdB"> <br />
    <script>
        function btnGcdOnClick() {
            let a = parseInt(document.getElementById('txtGcdA').value);
            let b = parseInt(document.getElementById('txtGcdB').value);
            let result = gcd(a, b);
            document.getElementById('gcdResult').innerHTML = result;
        }
    </script>
    <button id="btnGcd" onclick=btnGcdOnClick()>Submit</button> <br />
    <p id="gcdResult"></p>




    <h3>Number List Conversion</h3>
    Text:
    <input type="text" id="txtNumList">
    <script>
        function btnNumListOnClick() {
            let text = document.getElementById('txtNumList').value;
            text = cleanText(text);
            let nums = phTxtNums(text);
            document.getElementById('numListResult').innerHTML = nums;
        }
    </script>
    <button id="btnNumList" onclick=btnNumListOnClick()>Submit</button> <br />
    <p id="numListResult"></p>

    <h3>Exponentiation (Encrypt)</h3>
    Number List:
    <input type="text" id="txtExponentiateNums1"> <br />
    Exponent:
    <input type="text" id="txtExponentiatePow1"> <br />
    Modulus (<i>n</i>):
    <input type="text" id="txtExponentiateMod1"> <br />
    <script>
        function btnExponentiate1OnClick() {
            let numsStr = document.getElementById('txtExponentiateNums1').value;
            numsStr = removeSpaces(numsStr);
            let nums = numsStr.split(',');
            let t = parseInt(document.getElementById('txtExponentiatePow1').value);
            let p = parseInt(document.getElementById('txtExponentiateMod1').value);
            let result = phExponentiate(nums, t, p);
            document.getElementById('exponentiateResult1').innerHTML = result;
        }
    </script>
    <button id="btnExponentiate1" onclick=btnExponentiate1OnClick()>Submit</button><br />
    <p id="exponentiateResult1"></p>
    
    <h3>Multiplicative Inverse</h4>
    Number:
    <input type="text" id="txtMultInverseNum"> <br />
    Modulus:
    <input type="text" id="txtMultInverseMod"> <br />
    <script>
        function btnMultInverseOnClick() {
            let a = parseInt(document.getElementById('txtMultInverseNum').value);
            let b = parseInt(document.getElementById('txtMultInverseMod').value);
            let result = multInverseModn(a, b);
            document.getElementById('multInverseResult').innerHTML = result;        
        }
    </script>
    <button id="btnMultInverse" onclick=btnMultInverseOnClick()>Submit</button><br />
    <p id="multInverseResult"></p>

    <h3>Exponentiation (Decrypt)</h3>
    Number List:
    <input type="text" id="txtExponentiateNums2"> <br />
    Exponent (Inverse):
    <input type="text" id="txtExponentiatePow2"> <br />
    Modulus (<i>n</i>):
    <input type="text" id="txtExponentiateMod2"> <br />
    <script>
        function btnExponentiate2OnClick() {
            let numsStr = document.getElementById('txtExponentiateNums2').value;
            numsStr = removeSpaces(numsStr);
            let nums = numsStr.split(',');
            let t = parseInt(document.getElementById('txtExponentiatePow2').value);
            let p = parseInt(document.getElementById('txtExponentiateMod2').value);
            for(let i = 0; i < nums.length; i++) {
                nums[i] = parseInt(nums[i]);
            }
            let result = phExponentiate(nums, t, p);
            document.getElementById('exponentiateResult2').innerHTML = result;
        }
    </script>
    <button id="btnExponentiate2" onclick=btnExponentiate2OnClick()>Submit</button><br />
    <p id="exponentiateResult2"></p>
        <h3>Numbers to Text</h4>
        <input type="text" id="txtNumText"> <br />
        <script>
            function btnNumTxtOnClick() {
                let numsStr = document.getElementById('txtNumText').value;
                numsStr = removeSpaces(numsStr);
                let nums = numsStr.split(',');
                for(let i = 0; i < nums.length; i++) {
                    nums[i] = parseInt(nums[i]);
                }
                let result = phNumsTxt(nums);
                document.getElementById('numTxtResult').innerHTML = result;
            }
        </script>
        <button id="btnNumTxt" onclick=btnNumTxtOnClick()>Submit</button><br />
        <p id="numTxtResult"></p>
-->